{# This Script displays the datasets for a particular author. Might need to refactor this into the Profile later on. #}
{% extends "core/base.html" %}
{% block css %}
{{ block.super }}
<link href="/core_media/css/star_rating.css" rel="stylesheet" type="text/css" />
{% endblock %}

{% block container %}

{% if messages %}
	<div class="highlight" id="message">
		<ul>
		{% for message in messages %}
			<li>{{ message }}</li>
		{% endfor %}
		</ul>
	</div>
{% endif %}


{% load tags_templatetags %}
{% show_tag_cloud %}

{% if datasets %}

	<div>
	
	Datasets for 
	
	{{ requested_user.get_full_name }}
	
	[ {{ requested_user.username }} ]
	
	</div>
	
	{% comment %}
		'''
		"rate_box_view_helper" has to be always loaded whenever we are loading the 
		"rate_box_view" because of a dependecy JavaScript code that will be required 
		by this template.
		'''
	{% endcomment %}
	
	{% load djangoratings_templatetags %}
	{% rate_box_view_helper %}
	
 	{% for dataset in datasets %}
		<div id="databox">


  <div class="downloadicon"></div>
	
	{# consult micah and delete this #}
	{#% load dataset_templatetags %#}
	{#% show_dataset_title_view_ratebox_datainfo dataset %#}
	
	{% load djangoratings_templatetags %}
	{% rate_box_view dataset user %}
	
	<h1><a href="{% url datasets.views.view_dataset item_id=dataset.id %}">{{ dataset.name|escape }}</a></h1>
	<p>{{ dataset.description|escape|truncatewords:100 }}</p>

   	{% load tags_templatetags %}
	{% list_item_tags dataset %}
 	
 	{% if dataset.files %}
	  <h3>Attached Files</h3>
	  {% for file in dataset.files.all %}      
	    {# TODO: this should be a reverse? #}
	    <p><a href="{{ file.file_contents.url }}">{{ file.get_short_name }} (Download)</a></p>
	  {% endfor %}
	
	{% endif %}
 	
 	 
</div>
	{% endfor %}
{% endif %}

{% endblock %}