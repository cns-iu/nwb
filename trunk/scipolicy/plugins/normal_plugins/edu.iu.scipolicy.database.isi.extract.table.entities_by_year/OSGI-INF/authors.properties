menu_path=Extract/From ISI Database/end
label=Extract Authors By Year
description=This algorithm extracts the authors out of an ISI database into a table by year.
in_data=db:isi
out_data=prefuse.data.Table
service.pid=edu.iu.scipolicy.database.isi.extract.table.entities_by_year.ExtractAuthorsByYearAlgorithm
remoteable=true

query = \
SELECT \n\
	"Author", \n\
	"Year", \n\
	"Author ID", \n\
	COUNT (*) AS "Count" \n\
FROM \n\
	(SELECT \n\
			COALESCE ( \n\
				PERSON.FULL_NAME, \n\
				PERSON.UNSPLIT_NAME, \n\
				'**NO NAME SPECIFIED**') \n\
			AS "Author", \n\
		PERSON.PK AS "Author ID", \n\
			VARCHAR ( \n\
					COALESCE ( \n\
						CHAR (DOCUMENT.PUBLICATION_YEAR, 4), \n\
						'**NO PUBLICATION YEAR**'), \n\
					32000) \n\
				AS "Year" \n\
	FROM \n\
		DOCUMENT \n\
	JOIN \n\
		AUTHORS \n\
			ON (DOCUMENT.PK = AUTHORS.AUTHORS_DOCUMENT_FK) \n\
	JOIN \n\
		PERSON \n\
			ON (AUTHORS.AUTHORS_PERSON_FK = PERSON.PK) \n\
	) AS TEMP \n\
GROUP BY \n\
	"Author", \n\
	"Year", \n\
	"Author ID"

#query = \
#SELECT \n\
#	"Author", \n\
#	"Year", \n\
#	"Author ID", \n\
#	COUNT (*) AS "Count" \n\
#FROM \n\
#	(SELECT \n\
#			COALESCE ( \n\
#				PERSON.FULL_NAME, \n\
#				PERSON.UNSPLIT_NAME, \n\
#				'**NO NAME SPECIFIED**') \n\
#			AS "Author", \n\
#		PERSON.PK AS "Author ID", \n\
#		DOCUMENT.PUBLICATION_YEAR AS "Year" \n\
#	FROM \n\
#		DOCUMENT \n\
#	JOIN \n\
#		AUTHORS \n\
#			ON (DOCUMENT.PK = AUTHORS.AUTHORS_DOCUMENT_FK) \n\
#	JOIN \n\
#		PERSON \n\
#			ON (AUTHORS.AUTHORS_PERSON_FK = PERSON.PK) \n\
#	) AS TEMP \n\
#GROUP BY \n\
#	"Author", \n\
#	"Year", \n\
#	"Author ID"

output_label = Authors by Year