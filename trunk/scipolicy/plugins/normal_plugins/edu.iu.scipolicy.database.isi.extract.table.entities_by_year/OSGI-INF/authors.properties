menu_path=Extract/From ISI Database/end
label=Extract Authors By Year
description=This algorithm extracts the authors out of an ISI database into a table by year.
in_data=db:isi
out_data=prefuse.data.Table
service.pid=edu.iu.scipolicy.database.isi.extract.table.entities_by_year.ExtractAuthorsByYearAlgorithm
remoteable=true

query = \
SELECT \n\
	AUTHOR_LABEL, \n\
	"YEAR", \n\
	COUNT (*) AS NUMBER_OF_AUTHORED_WORKS_THIS_YEAR \n\
FROM \n\
	(SELECT \n\
		VARCHAR ( \n\
				COALESCE ( \n\
					PERSON.FULL_NAME || ' ' || CHAR (PERSON.PK, 20), \n\
					PERSON.UNSPLIT_NAME || ' ' || CHAR (PERSON.PK, 20), \n\
					AUTHORS.EMAIL_ADDRESS || ' ' || CHAR (PERSON.PK, 20)), \n\
				32000) \n\
			AS AUTHOR_LABEL, \n\
		DOCUMENT.PUBLICATION_YEAR AS "YEAR" \n\
	FROM \n\
		DOCUMENT \n\
	JOIN \n\
		AUTHORS \n\
			ON (DOCUMENT.PK = AUTHORS.AUTHORS_DOCUMENT_FK) \n\
	JOIN \n\
		PERSON \n\
			ON (AUTHORS.AUTHORS_PERSON_FK = PERSON.PK) \n\
	) AS TEMP \n\
GROUP BY \n\
	AUTHOR_LABEL, \n\
	"YEAR"

output_label = Authors by Year