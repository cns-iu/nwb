menu_path=Extract/ISI/additions
label=Extract Authors
description=Extracts the table of authors from an ISI database
in_data=db:isi
out_data=prefuse.data.Table
service.pid=edu.iu.scipolicy.database.isi.extract.table.core_entities.ExtractAuthorsAlgorithm
remoteable=false
 
query = \n\
SELECT \n\
	PERSON1.UNSPLIT_NAME, \n\
	COUNT(*) AS PAPERS_AUTHORED_IN_DATASET, \n\
	SUM(DOCUMENT1.TIMES_CITED) AS GLOBAL_CITATION_COUNT, \n\
	SUM(Coalesce(TEMP.LOCAL_CITATION_COUNT, 0)) AS LOCAL_CITATION_COUNT, \n\
	PERSON1.ADDITIONAL_NAME, \n\
	PERSON1.FAMILY_NAME, \n\
	PERSON1.FIRST_INITIAL, \n\
	PERSON1.FULL_NAME, \n\
	PERSON1.MIDDLE_INITIAL, \n\
	PERSON1.PERSONAL_NAME \n\
FROM \n\
	PERSON PERSON1 \n\
JOIN \n\
	AUTHORS AUTHORS1  --DERBY-PROPERTIES joinStrategy=HASH \n\
		ON (PERSON1.PK = AUTHORS1.AUTHORS_PERSON_FK) \n\
JOIN \n\
	DOCUMENT DOCUMENT1  --DERBY-PROPERTIES joinStrategy=HASH \n\
		ON (AUTHORS1.AUTHORS_DOCUMENT_FK = DOCUMENT1.PK) \n\
LEFT JOIN \n\
	( \n\
		SELECT \n\
			DOCUMENT2.PK AS TEMP_PK, \n\
			COUNT(*) AS LOCAL_CITATION_COUNT \n\
		FROM \n\
			DOCUMENT DOCUMENT2 \n\
		JOIN \n\
			REFERENCE REFERENCE1  --DERBY-PROPERTIES joinStrategy=HASH \n\
				ON (DOCUMENT2.PK = REFERENCE1.PAPER_FK) \n\
		JOIN \n\
			CITED_REFERENCES CITED_REFERENCES1  --DERBY-PROPERTIES joinStrategy=HASH \n\
				ON (REFERENCE1.PK = CITED_REFERENCES1.CITED_REFERENCES_REFERENCE_FK) \n\
		GROUP BY \n\
			DOCUMENT2.PK \n\
	) AS TEMP --DERBY-PROPERTIES joinStrategy=HASH \n\
		ON (TEMP.TEMP_PK = DOCUMENT1.PK) \n\
GROUP BY  \n\
	PERSON1.PK, \n\
	PERSON1.ADDITIONAL_NAME, \n\
	PERSON1.FAMILY_NAME, \n\
	PERSON1.FIRST_INITIAL, \n\
	PERSON1.FULL_NAME, \n\
	PERSON1.MIDDLE_INITIAL, \n\
	PERSON1.PERSONAL_NAME, \n\
	PERSON1.UNSPLIT_NAME

output_label= Authors
