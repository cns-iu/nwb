menu_path=Extract/ISI/additions
label=Extract Authors
description=Extracts the table of authors from an ISI database
in_data=db:isi
out_data=prefuse.data.Table
service.pid=edu.iu.scipolicy.database.isi.extract.table.core_entities.ExtractAuthorsAlgorithm
remoteable=false
 
query = \
SELECT \
	PERSON1.UNSPLIT_NAME, \
	COUNT(*) AS PAPERS_AUTHORED_IN_DATASET, \
	SUM(DOCUMENT1.TIMES_CITED) AS GLOBAL_CITATION_COUNT, \
	SUM(TEMP.LOCAL_CITATION_COUNT) AS LOCAL_CITATION_COUNT, \
	PERSON1.ADDITIONAL_NAME, \
	PERSON1.FAMILY_NAME, \
	PERSON1.FIRST_INITIAL, \
	PERSON1.FULL_NAME, \
	PERSON1.MIDDLE_INITIAL, \
	PERSON1.PERSONAL_NAME \
FROM \
	PERSON PERSON1 \
JOIN \
	AUTHORS AUTHORS1 \
		ON (PERSON1.PK = AUTHORS1.AUTHORS_PERSON_FK) \
JOIN \
	DOCUMENT DOCUMENT1 \
		ON (AUTHORS1.AUTHORS_DOCUMENT_FK = DOCUMENT1.PK) \
JOIN \
	( \
		SELECT \
			DOCUMENT2.PK AS TEMP_PK, \
			COUNT(*) AS LOCAL_CITATION_COUNT \
		FROM \
			DOCUMENT DOCUMENT2 \
		JOIN \
			REFERENCE REFERENCE1 \
				ON (DOCUMENT2.PK = REFERENCE1.PAPER_FK) \
		JOIN \
			CITED_REFERENCES CITED_REFERENCES1 \
				ON (REFERENCE1.PK = CITED_REFERENCES1.CITED_REFERENCES_REFERENCE_FK) \
		GROUP BY \
			DOCUMENT2.PK \
	) AS TEMP \
		ON (TEMP.TEMP_PK = DOCUMENT1.PK) \
GROUP BY \
	PERSON1.PK, \
	PERSON1.ADDITIONAL_NAME, \
	PERSON1.FAMILY_NAME, \
	PERSON1.FIRST_INITIAL, \
	PERSON1.FULL_NAME, \
	PERSON1.MIDDLE_INITIAL, \
	PERSON1.PERSONAL_NAME, \
	PERSON1.UNSPLIT_NAME

output_label= Authors
