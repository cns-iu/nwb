menu_path=Extract/NSF/start
label=Co-PI Network
description=Extract the co-investigatorship network from this database.
in_data=db:nsf
out_data=prefuse.data.Graph
service.pid=edu.iu.scipolicy.database.extract.network.cocreator.nsf
remoteable=true
node_query= \
SELECT   person.pk                         AS id, \n\
         person.formatted_full_name        AS label, \n\
         Count(* )                         AS awards, \n\
         Sum(award.awarded_amount_to_date) AS totalawardmoney, \n\
         Min(award.start_date)             AS earlieststartdate, \n\
         Max(award.expiration_date)        AS latestexpirationdate \n\
FROM     investigators \n\
         JOIN award \n\
           ON (investigators.i_award_fk = award.pk) \n\
         JOIN person \n\
           ON (investigators.i_person_fk = person.pk) \n\
GROUP BY person.pk, person.formatted_full_name \n\
ORDER BY label
edge_query= \
SELECT   person1.pk                  AS source, \n\
         person2.pk                  AS target, \n\
         person1.formatted_full_name AS sourcelabel, \n\
         person2.formatted_full_name AS targetlabel, \n\
         Count(* )                   AS coinvestigatedawards, \n\
         Count(* )                   AS weight \n\
FROM     investigators investigators1 \n\
         JOIN investigators investigators2 \n\
           ON (investigators1.i_award_fk = investigators2.i_award_fk) \n\
         JOIN award \n\
           ON (investigators1.i_award_fk = award.pk) \n\
         JOIN person person1 \n\
           ON (investigators1.i_person_fk = person1.pk) \n\
         JOIN person person2 \n\
           ON (investigators2.i_person_fk = person2.pk) \n\
WHERE    person1.pk < person2.pk \n\
GROUP BY person1.pk, person1.formatted_full_name, person2.pk, person2.formatted_full_name \n\
ORDER BY sourcelabel, targetlabel
id_column=ID
source_column=SOURCE
target_column=TARGET
directed=false
output_label=Co-PI network