menu_path=Extract/NSF/start
label=Extract Co-Investigatorship Network
description=Extract the co-investigatorship network from the database.
in_data=db:nsf
out_data=prefuse.data.Graph
service.pid=edu.iu.scipolicy.database.extract.network.cocreator.nsf
remoteable=true
node_query= \
SELECT   person.pk                         AS id, \n\
         Max(person.formatted_full_name)   AS label, \n\
         Count(* )                         AS awards, \n\
         Sum(award.awarded_amount_to_date) AS totalawardmoney, \n\
         Min(award.start_date)             AS earlieststartdate, \n\
         Max(award.expiration_date)        AS latestexpirationdate \n\
FROM     investigators \n\
         JOIN award \n\
           ON (investigators.i_award_fk = award.pk) \n\
         JOIN person \n\
           ON (investigators.i_person_fk = person.pk) \n\
GROUP BY person.pk \n\
ORDER BY label
edge_query= \
SELECT   person1.pk                       AS source, \n\
         person2.pk                       AS target, \n\
         Max(person1.formatted_full_name) AS sourcelabel, \n\
         Max(person2.formatted_full_name) AS targetlabel, \n\
         Count(* )                        AS coinvestigatedawards, \n\
         Count(* )                        AS weight \n\
FROM     investigators investigators1 \n\
         JOIN investigators investigators2 \n\
           ON (investigators1.i_award_fk = investigators2.i_award_fk) \n\
         JOIN award \n\
           ON (investigators1.i_award_fk = award.pk) \n\
         JOIN person person1 \n\
           ON (investigators1.i_person_fk = person1.pk) \n\
         JOIN person person2 \n\
           ON (investigators2.i_person_fk = person2.pk) \n\
WHERE    person1.pk < person2.pk \n\
GROUP BY person1.pk, person2.pk \n\
ORDER BY sourcelabel, targetlabel
id_column=ID
source_column=SOURCE
target_column=TARGET
directed=false
output_label=Co-investigatorship network