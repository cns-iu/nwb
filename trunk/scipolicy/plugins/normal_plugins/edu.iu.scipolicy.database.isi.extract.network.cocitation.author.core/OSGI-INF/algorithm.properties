menu_path=Extract/ISI/start
label=Author Co-Citation Network
description=Extracts the author co-citation network from this database.
in_data=db:isi
out_data=prefuse.data.Graph
service.pid=edu.iu.scipolicy.database.isi.extract.network.cocitation.author.core
remoteable=true
node_query= \
SELECT   id, \n\
         label, \n\
		 Count(DISTINCT work_fk) AS number_of_authored_works, \n\
		 Sum(tc)                 AS times_cited, \n\
		 additional_name, \n\
         family_name, \n\
         first_initial, \n\
         full_name, \n\
         middle_initial, \n\
         personal_name, \n\
         unsplit_name, \n\
         email_address \n\
FROM     (SELECT person.pk                                      AS id, \n\
                 Coalesce(person.full_name, \n\
                          person.unsplit_name, \n\
                          authors.email_address, \n\
                          'Person with ID ' || Char(person.pk)) AS label, \n\
			     authors.authors_document_fk                    AS work_fk, \n\
				 document.times_cited                           AS tc, \n\
                 person.additional_name, \n\
                 person.family_name, \n\
                 person.first_initial, \n\
                 person.full_name, \n\
                 person.middle_initial, \n\
                 person.personal_name, \n\
                 person.unsplit_name, \n\
                 authors.email_address \n\
          FROM   authors \n\
                 JOIN person \n\
                   ON (authors.authors_person_fk = person.pk) \n\
				 JOIN document \n\
                   ON (authors.authors_document_fk = document.pk)) AS TEMP \n\
GROUP BY id, \n\
         label, \n\
         additional_name, \n\
         family_name, \n\
         first_initial, \n\
         full_name, \n\
         middle_initial, \n\
         personal_name, \n\
         unsplit_name, \n\
         email_address
edge_query= \
SELECT   cited_author1.authors_person_fk       AS source, \n\
         cited_author2.authors_person_fk       AS target, \n\
         Count(* )                             AS timescocited, \n\
         Count(* )                             AS weight, \n\
         Min(citing_document.publication_year) AS earliestcocitation, \n\
         Max(citing_document.publication_year) AS latestcocitation \n\
FROM     cited_references cited_references1 \n\
         JOIN cited_references cited_references2 \n\
           ON (cited_references1.cited_references_document_fk = cited_references2.cited_references_document_fk) \n\
         JOIN document citing_document \n\
           ON (cited_references1.cited_references_document_fk = citing_document.pk) \n\
         JOIN reference reference1 \n\
           ON (cited_references1.cited_references_reference_fk = reference1.pk) \n\
         JOIN document cited_document1 \n\
           ON (reference1.paper_fk = cited_document1.pk) \n\
         JOIN authors cited_author1 \n\
           ON (cited_document1.pk = cited_author1.authors_document_fk) \n\
         JOIN reference reference2 \n\
           ON (cited_references2.cited_references_reference_fk = reference2.pk) \n\
         JOIN document cited_document2 \n\
           ON (reference2.paper_fk = cited_document2.pk) \n\
         JOIN authors cited_author2 \n\
           ON (cited_document2.pk = cited_author2.authors_document_fk) \n\
WHERE    cited_author1.authors_person_fk < cited_author2.authors_person_fk \n\
GROUP BY cited_author1.authors_person_fk, cited_author2.authors_person_fk
id_column=ID
source_column=SOURCE
target_column=TARGET
directed=false
output_label=Author co-citation network