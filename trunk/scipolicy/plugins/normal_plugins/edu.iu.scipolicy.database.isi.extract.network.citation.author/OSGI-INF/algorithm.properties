menu_path=Extract/ISI/end
label=Extract Author Citation Network
description=This algorithm extracts an Author to Author citation network from an ISI database.
in_data=db:isi
out_data=prefuse.data.Graph
service.pid=edu.iu.scipolicy.database.isi.extract.network.citation.author.ISIExtractAuthorCitationNetworkAlgorithm
remoteable=true

node_query= \
SELECT \n\
	ID, \n\
	ADDITIONAL_NAME, \n\
	FAMILY_NAME, \n\
	FIRST_INITIAL, \n\
	FULL_NAME, \n\
	MIDDLE_INITIAL, \n\
	PERSONAL_NAME, \n\
	UNSPLIT_NAME, \n\
	LABEL, \n\
	COUNT (DISTINCT WORK_FK) AS NUMBER_AUTHORED_WORKS \n\
FROM \n\
	(SELECT \n\
		PERSON.PK AS ID, \n\
		PERSON.ADDITIONAL_NAME, \n\
		PERSON.FAMILY_NAME, \n\
		PERSON.FIRST_INITIAL, \n\
		PERSON.FULL_NAME, \n\
		PERSON.MIDDLE_INITIAL, \n\
		PERSON.PERSONAL_NAME, \n\
		PERSON.UNSPLIT_NAME, \n\
		COALESCE( \n\
				PERSON.FULL_NAME, \n\
				PERSON.UNSPLIT_NAME, \n\
				'Person with ID ' || CHAR (PERSON.PK)) \n\
			AS LABEL, \n\
		AUTHORS.AUTHORS_DOCUMENT_FK AS WORK_FK \n\
	FROM \n\
		PERSON \n\
	LEFT JOIN \n\
		AUTHORS \n\
			ON (PERSON.PK = AUTHORS.AUTHORS_PERSON_FK) \n\
	) AS TEMP \n\
GROUP BY \n\
	ID, \n\
	ADDITIONAL_NAME, \n\
	FAMILY_NAME, \n\
	FIRST_INITIAL, \n\
	FULL_NAME, \n\
	MIDDLE_INITIAL, \n\
	PERSONAL_NAME, \n\
	UNSPLIT_NAME, \n\
	LABEL

edge_query= \
SELECT \n\
	AUTHORS1.AUTHORS_PERSON_FK AS TARGET, \n\
	AUTHORS2.AUTHORS_PERSON_FK AS SOURCE, \n\
	COUNT (*) AS WEIGHT, \n\
	MIN (DOCUMENT1.PUBLICATION_YEAR) AS FIRST_TIME_CITED \n\
FROM \n\
	DOCUMENT DOCUMENT1 \n\
JOIN \n\
	AUTHORS AUTHORS1 \n\
		ON (DOCUMENT1.PK = AUTHORS1.AUTHORS_DOCUMENT_FK) \n\
JOIN \n\
	CITED_REFERENCES \n\
		ON (DOCUMENT1.PK = CITED_REFERENCES.CITED_REFERENCES_DOCUMENT_FK) \n\
JOIN \n\
	REFERENCE \n\
		ON (CITED_REFERENCES.CITED_REFERENCES_REFERENCE_FK = REFERENCE.PK) \n\
JOIN \n\
	DOCUMENT DOCUMENT2 \n\
		ON (REFERENCE.PAPER_FK = DOCUMENT2.PK) \n\
JOIN \n\
	AUTHORS AUTHORS2 \n\
		ON (DOCUMENT2.PK = AUTHORS2.AUTHORS_DOCUMENT_FK) \n\
GROUP BY \n\
	AUTHORS1.AUTHORS_PERSON_FK, \n\
	AUTHORS2.AUTHORS_PERSON_FK

id_column=ID
source_column=SOURCE
target_column=TARGET
directed=true
output_label=Author Citation Network