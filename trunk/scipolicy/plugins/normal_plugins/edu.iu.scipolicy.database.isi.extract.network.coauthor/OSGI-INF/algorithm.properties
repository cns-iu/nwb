menu_path=Extract/ISI/start
label=Co-Authorship Network
description=Extract the co-authorship network from this database.
in_data=db:isi
out_data=prefuse.data.Graph
service.pid=edu.iu.scipolicy.database.isi.extract.network.coauthor
remoteable=true
node_query= \
SELECT   id, \n\
         label, \n\
		 Count(DISTINCT work_fk) AS number_of_authored_works, \n\
		 Sum(tc)                 AS times_cited, \n\
		 additional_name, \n\
         family_name, \n\
         first_initial, \n\
         full_name, \n\
         middle_initial, \n\
         personal_name, \n\
         unsplit_name \n\
FROM     (SELECT person.pk                                      AS id, \n\
                 Coalesce(person.full_name, \n\
                          person.unsplit_name, \n\
                          'Person with ID ' || Char(person.pk)) AS label, \n\
			     authors.authors_document_fk                    AS work_fk, \n\
				 document.times_cited                           AS tc, \n\
                 person.additional_name, \n\
                 person.family_name, \n\
                 person.first_initial, \n\
                 person.full_name, \n\
                 person.middle_initial, \n\
                 person.personal_name, \n\
                 person.unsplit_name \n\
          FROM   authors \n\
                 JOIN person \n\
                   ON (authors.authors_person_fk = person.pk) \n\
				 JOIN document \n\
                   ON (authors.authors_document_fk = document.pk)) AS TEMP \n\
GROUP BY id, \n\
         label, \n\
         additional_name, \n\
         family_name, \n\
         first_initial, \n\
         full_name, \n\
         middle_initial, \n\
         personal_name, \n\
         unsplit_name
edge_query= \
SELECT   person1.pk                     AS source, \n\
         person2.pk                     AS target, \n\
         Count(* )                      AS number_of_coauthored_works, \n\
		 Count(* )                      AS weight, \n\
		 Min(document.publication_year) AS earliest_collaboration, \n\
		 Max(document.publication_year) AS latest_collaboration \n\
FROM     authors authors1 \n\
         JOIN authors authors2 \n\
           ON (authors1.authors_document_fk = authors2.authors_document_fk) \n\
         JOIN document \n\
           ON (authors1.authors_document_fk = document.pk) \n\
         JOIN person person1 \n\
           ON (authors1.authors_person_fk = person1.pk) \n\
         JOIN person person2 \n\
           ON (authors2.authors_person_fk = person2.pk) \n\
WHERE    person1.pk < person2.pk \n\
GROUP BY person1.pk, person2.pk
id_column=ID
source_column=SOURCE
target_column=TARGET
directed=false
output_label=Co-authorship network