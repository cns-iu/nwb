menu_path=Extract/ISI/start
label=Co-Authorship Network
description=Extract the co-authorship network from this database.
in_data=db:isi
out_data=prefuse.data.Graph
service.pid=edu.iu.scipolicy.database.extract.network.cocreator.isi
remoteable=true
node_query= \
SELECT   person.pk                 AS id, \n\
         person.unsplit_name       AS label, \n\
         Count(* )                 AS numberofworks, \n\
         Sum(document.times_cited) AS timescited \n\
FROM     authors \n\
         JOIN document \n\
           ON (authors.authors_document_fk = document.pk) \n\
         JOIN person \n\
           ON (authors.authors_person_fk = person.pk) \n\
GROUP BY person.pk, person.unsplit_name \n\
ORDER BY label
edge_query= \
SELECT   person1.pk           AS source, \n\
         person2.pk           AS target, \n\
         person1.unsplit_name AS sourcelabel, \n\
         person2.unsplit_name AS targetlabel, \n\
         Count(* )            AS numberofcoauthoredworks \n\
FROM     authors authors1 \n\
         JOIN authors authors2 \n\
           ON (authors1.authors_document_fk = authors2.authors_document_fk) \n\
         JOIN document \n\
           ON (authors1.authors_document_fk = document.pk) \n\
         JOIN person person1 \n\
           ON (authors1.authors_person_fk = person1.pk) \n\
         JOIN person person2 \n\
           ON (authors2.authors_person_fk = person2.pk) \n\
WHERE    person1.pk < person2.pk \n\
GROUP BY person1.pk, person1.unsplit_name, person2.pk, person2.unsplit_name \n\
ORDER BY sourcelabel, targetlabel
id_column=ID
source_column=SOURCE
target_column=TARGET
directed=false
output_label=Co-authorship network