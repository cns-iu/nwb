menu_path=Extract/ISI/start
label=Extract Co-Author Network
description=Extract the co-authorship network from this database.
in_data=db:isi
out_data=prefuse.data.Graph
service.pid=edu.iu.sci2.database.isi.extract.network.coauthor
remoteable=true
documentation_url=http://wiki.cns.iu.edu/display/CISHELL/Extract+Co-Author+Network

node_query= \
SELECT   id, \n\
label, \n\
Count(DISTINCT work_fk) AS number_of_authored_works, \n\
Sum(tc)                 AS times_cited, \n\
additional_name, \n\
family_name, \n\
first_initial, \n\
full_name, \n\
middle_initial, \n\
personal_name, \n\
unsplit_name, \n\
min(publication_year) as earliest_publication, \n\
max(publication_year) as latest_publication \n\
FROM     (SELECT person.pk                                      AS id, \n\
Coalesce(person.full_name, \n\
person.unsplit_name, \n\
'Person with ID ' || Char(person.pk)) AS label, \n\
authors.authors_document_fk                    AS work_fk, \n\
document.times_cited                           AS tc, \n\
person.additional_name, \n\
person.family_name, \n\
person.first_initial, \n\
person.full_name, \n\
person.middle_initial, \n\
person.personal_name, \n\
person.unsplit_name, \n\
document.publication_year AS publication_year \n\
FROM   authors \n\
JOIN person  --DERBY-PROPERTIES joinStrategy=HASH \n\
ON (authors.authors_person_fk = person.pk) \n\
JOIN document --DERBY-PROPERTIES joinStrategy=HASH \n\
ON (authors.authors_document_fk = document.pk)) AS TEMP \n\
GROUP BY id, \n\
label, \n\
additional_name, \n\
family_name, \n\
first_initial, \n\
full_name, \n\
middle_initial, \n\
personal_name, \n\
unsplit_name
edge_query= \
SELECT   source, \n\
target, \n\
works as number_of_coauthored_works, \n\
works as weight, \n\
CAST(works * 1.0 / (a1total + a2total - works) AS DOUBLE) as jaccard, \n\
CAST(works * 1.0 / (SQRT(a1total) * SQRT(a2total)) AS DOUBLE) AS cosine, \n\
CAST(works * 2.0 / (a1total + a2total) AS DOUBLE) AS dice, \n\
earliest_collaboration, \n\
latest_collaboration \n\
FROM (SELECT   authors1.authors_person_fk                     AS source, \n\
authors2.authors_person_fk                     AS target, \n\
Count(distinct document.pk )                      AS works, \n\
a1works.total AS a1total, \n\
a2works.total as a2total, \n\
Min(document.publication_year) AS earliest_collaboration, \n\
Max(document.publication_year) AS latest_collaboration \n\
FROM     authors authors1 \n\
JOIN authors authors2  --DERBY-PROPERTIES joinStrategy=HASH \n\
ON (authors1.authors_document_fk = authors2.authors_document_fk) \n\
JOIN document  --DERBY-PROPERTIES joinStrategy=HASH \n\
ON (authors1.authors_document_fk = document.pk) \n\
JOIN (SELECT authors_person_fk, count(distinct authors_document_fk) as total from authors group by authors_person_fk) AS a1works  --DERBY-PROPERTIES joinStrategy=HASH \n\
ON a1works.authors_person_fk = authors1.authors_person_fk \n\
JOIN (SELECT authors_person_fk, count(distinct authors_document_fk) as total from authors group by authors_person_fk) AS a2works --DERBY-PROPERTIES joinStrategy=HASH \n\
ON a2works.authors_person_fk = authors2.authors_person_fk \n\
WHERE    authors1.authors_person_fk < authors2.authors_person_fk \n\
GROUP BY authors1.authors_person_fk, authors2.authors_person_fk, a1works.total, a2works.total) AS inner_query
id_column=ID
source_column=SOURCE
target_column=TARGET
directed=false
output_label=Co-Author network
documentation_url=https://nwb.cns.iu.edu/community/?n=Sci2Algorithm.ISIExtractCoAuthor
