== Requirements == 

The code is pretty straightforward, but I use gsl for the random number generator, so you need to link it with the appropriate libraries. 

Right now, the Makefile is hand crafted so it is not particularly generic. I'll try to add autotools support before we "release" the final version. In the mean time,  you'll have to take a look at the directories in the Makefile and make sure they make sense. In particular, you should have to change /sw/include/ since this is a Mac convention.

== Compiling == 

Assuming you adjusted the appropriate directories,

-> make 

should work fine and generate SPEM.x. In case you need to compile with debugging flags (for use with gdb) you can just do

-> make dbg

to create SPEM_dbg.x. Finally, 

-> make clean 

will remove all executable and object files.

== Running SPEMShell ==

You can create a couple of test directories using:

-> make test_dir

After which you should have this directory structure:

runs/
-- multi/
---- 1247499707714.A0C/
------ output/
-- single/
---- 1247498152606.1EE/
------output/

With example .in .mdl and .cfg files inside the 1247499707714.A0C/ and 1247498152606.1EE/ directories. At this point you should be able to do:

-> ./SPEMShell.py runs/multi/1247499707714.A0C/
   Running in runs/multi/1247499707714.A0C/
   Running 3 runs for 3 compartments
   Child 83145 exited with status 0
   Child 83156 exited with status 0
   Child 83177 exited with status 0
->

to run the multi run and

-> ./SPEMShell.py runs/single/1247498152606.1EE/
   Running in runs/single/1247498152606.1EE/
   Running 1 runs for 3 compartments
   Child 83515 exited with status 0
->

for the single run. During each run, you should be able to find the pid numbers of the respective SPEM.x instance in the respective directories as agreed. 

== Input ==
outVal:
> In the format.pdf, it is the label to be output. Please let me know if i'm
> wrong. If there are three compartment with the following labels:
> COMPARTMENT_A, COMPARTMENT_B and COMPARTMENT_C. The outVal value should be
> "COMPARTMENT_A;COMPARTMENT_B;COMPARTMENT_C"
This is correct.

> maxRuns:
> What is the MAX_RUN? How to decide the suitable value for MAX_RUN?
maxRuns is the maximum number of tries that the code will run. If
there is no outbreak after these many tries, it quits. (otherwise it
would run forever). I usually keep it at 100. If there is no outbreak
after 100 runs, chances are that there is something wrong with the
model specified.

> output_frames:
> What is output_frames? Should we always use 'none'?
Right now, "none" is correct value. The most general code has support
for day by day animations in the case of single runs. This is the
directly where the resulting time frames should go. In the case of a
single population, this is not particularly interesting, but it will
become more relevant in the network version.

> initial.txt:
> If I understand the Python code right, this file contains all the initial
> populations of all compartments. For example,
> COMPARTMENT_A 1000
> COMPARTMENT_B 100
> COMPARTMENT_C 0
Just the non-zero ones are required, and they should be in percentage
(50%) or fraction (.5) and should sum up to 100% (or 1.).

> nonTravel:
> What is the content in the file? How to generate it in Epic?
Non traveling. Irrelevant for single population.

> rho:
> Same question with NT.txt
Non commuting. Again, irrelevant for single population.

== Output ==

This version has limited output capabilities, as NO post processing is currently being done. Afer each run, you'll find the output generated inside the output_data/ sub directory. For each run there are three files, but only *.out.dat.gz is interesting for us right now. Here you'll find the complete information for each compartment and basin at each time step. The order in which the compartments are listed (since it varies from model to model) is listed in the first line. The first column represents the basin and the second time step starting at 0. 

The other two files *.err.dat.gz and *.sec.dat.gz also contain interesting information (like number of transitions and number of secondary cases at each time-basin pair), but they still need to be modified to fit the formats we agreed. 

There is still no support for averages/CI. I'm currently working on those and hope to have them done by tomorrow or wed.

== Caveats ==

At this point, SPEMShell.py assumes the directory structure I'm sending in this package. In particular, SPEM.x and data/ should be in the same directory from where SPEMShell.py is called and above the "runs/" directory. I can add a configuration file for SPEMShell.py if you want