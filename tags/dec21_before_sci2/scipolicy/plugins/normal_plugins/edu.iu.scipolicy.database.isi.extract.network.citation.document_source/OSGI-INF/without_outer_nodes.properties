menu_path=Extract/ISI/end
label=Extract Document Source Citation Network (Core Only)
description=This algorithm extracts a Document Source to Document Source citation network from an ISI database, with core nodes only.
in_data=db:isi
out_data=prefuse.data.Graph
service.pid=edu.iu.scipolicy.database.isi.extract.network.citation.document_source.ISIDocumentSourceCitationNetworkWithoutOuterNodes
remoteable=true

node_query= \
SELECT \n\
	SOURCE.PK AS ID, \n\
	SOURCE.FULL_TITLE, \n\
	SOURCE.ISO_TITLE_ABBREVIATION, \n\
	SOURCE.TWENTY_NINE_CHARACTER_SOURCE_TITLE_ABBREVIATION, \n\
	SOURCE.PUBLICATION_TYPE, \n\
	SOURCE.ISSN, \n\
	SOURCE.BOOK_SERIES_TITLE, \n\
	SOURCE.BOOK_SERIES_SUBTITLE, \n\
	SOURCE.CONFERENCE_TITLE, \n\
	SOURCE.CONFERENCE_HOST, \n\
	SOURCE.CONFERENCE_LOCATION, \n\
	SOURCE.CONFERENCE_SPONSORS, \n\
	COALESCE( \n\
			SOURCE.FULL_TITLE, \n\
			SOURCE.ISO_TITLE_ABBREVIATION, \n\
			SOURCE.TWENTY_NINE_CHARACTER_SOURCE_TITLE_ABBREVIATION, \n\
			'Source with ID ' || CHAR (SOURCE.PK)) \n\
		AS LABEL \n\
FROM \n\
	SOURCE \n\
WHERE EXISTS (SELECT DOCUMENT.DOCUMENT_SOURCE_FK FROM DOCUMENT WHERE DOCUMENT.DOCUMENT_SOURCE_FK = SOURCE.PK)

edge_query= \
SELECT \n\
	SOURCE1.PK AS TARGET, \n\
	SOURCE2.PK AS SOURCE, \n\
	COUNT (*) AS WEIGHT \n\
FROM \n\
	SOURCE SOURCE1 \n\
JOIN \n\
	DOCUMENT DOCUMENT1 \n\
		ON (SOURCE1.PK = DOCUMENT1.DOCUMENT_SOURCE_FK) \n\
JOIN \n\
	CITED_REFERENCES \n\
		ON (DOCUMENT1.PK = CITED_REFERENCES.CITED_REFERENCES_DOCUMENT_FK) \n\
JOIN \n\
	REFERENCE \n\
		ON (CITED_REFERENCES.CITED_REFERENCES_REFERENCE_FK = REFERENCE.PK) \n\
JOIN \n\
	DOCUMENT DOCUMENT2 \n\
		ON (REFERENCE.PAPER_FK = DOCUMENT2.PK) \n\
JOIN \n\
	SOURCE SOURCE2 --DERBY-PROPERTIES joinStrategy=HASH \n\
		ON (DOCUMENT2.DOCUMENT_SOURCE_FK = SOURCE2.PK) \n\
GROUP BY \n\
	SOURCE1.PK, \n\
	SOURCE2.PK

id_column=ID
source_column=SOURCE
target_column=TARGET
directed=true
output_label=Document Source Citation Network (Core Only)